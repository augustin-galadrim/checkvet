components:
- layout_properties: {slot: feedback_slot}
  name: user_feedback_1
  properties: {}
  type: form:Components.UserFeedback
- layout_properties: {slot: playback_slot}
  name: audio_playback_1
  properties: {}
  type: form:Components.AudioPlayback
- layout_properties: {slot: editor_slot}
  name: text_editor_1
  properties: {show_undo_redo_buttons: true}
  type: form:Components.TextEditor
- event_bindings: {x_save_clicked: report_footer_1_save_clicked, x_status_clicked: report_footer_1_status_clicked}
  layout_properties: {slot: bottom_buttons_slot}
  name: report_footer_1
  properties: {}
  type: form:Components.ReportFooter
- layout_properties: {slot: recorder_slot}
  name: recording_widget_1
  properties: {}
  type: form:Components.RecordingWidget
- data_bindings:
  - {code: 'self.item['''']', property: title, writeback: false}
  layout_properties: {slot: default}
  name: header_return_1
  properties: {return_form: Archives.ArchivesForm, title: ''}
  type: form:Components.HeaderReturn
container:
  properties:
    html: "<!DOCTYPE html>\n<html lang=\"fr\">\n  <head>\n    <meta charset=\"UTF-8\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Edit Report</title>\n    <style>\n      :root {\n        --footer-height: 75px; \n      }\n      * { box-sizing: border-box; font-family: Arial, sans-serif; margin: 0; padding: 0; }\n      body { background-color: #f5f5f5; height: 100vh; overflow: hidden; }\n\n      .scrollable-content {\n        flex: 1;\n        overflow-y: auto;\n        padding: 20px;\n        padding-bottom: calc(var(--footer-height) + 20px);\n      }\n\n      .edit-audio-section {\n        padding: 15px;\n        margin-bottom: 20px;\n        text-align: center;\n      }\n\n      .edit-instructions {\n        font-size: 14px; color: #555; margin-bottom: 10px; border: 1px solid #ddd;  box-shadow: 0 2px 5px rgba(0,0,0,0.05); background: #f8f8f8;         padding: 15px;\n        border-radius: 8px;\n      }\n      .edit-instructions em {\n        color: #333;\n        background-color: #e9e9e9;\n        padding: 2px 5px;\n        border-radius: 3px;\n      }\n\n      #audioInputContainer, #audioDecisionContainer, #audioProcessingContainer {\n        width: 100%; display: none;\n      }\n      #audioDecisionContainer {\n        display: flex; flex-direction: column; align-items: center; gap: 10px;\n      }\n      .decision-buttons { display: flex; gap: 15px; }\n      .decision-button { padding: 10px 20px; border-radius: 4px; border: 1px solid #ddd; cursor: pointer; font-size: 14px; font-weight: bold; }\n      .process { background-color: #4CAF50; color: white; border-color: #4CAF50; }\n      .discard { background-color: #f44336; color: white; border-color: #f44336; }\n    </style>\n  </head>\n  <body>\n    <div class=\"responsive-container\" id=\"editor-stable-anchor\">\n      <div anvil-slot=\"default\"></div>\n\n      <div class=\"scrollable-content\">\n\n        <div class=\"edit-audio-section\">\n          <div id=\"audioInputContainer\">\n            <div class=\"edit-instructions\">\n              <p id=\"audioManagerEdit-p-instructions\"></p>\n              <p>\n                <strong id=\"audioManagerEdit-strong-example\"></strong>\n                <em id=\"audioManagerEdit-em-exampleText\"></em>\n              </p>\n            </div>\n            <div anvil-slot=\"recorder_slot\"></div>\n          </div>\n\n          <div id=\"audioDecisionContainer\">\n            <div anvil-slot=\"playback_slot\"></div>\n            <div class=\"decision-buttons\">\n              <button id=\"audioManagerEdit-button-discard\" class=\"decision-button discard\">Discard modification</button>\n              <button id=\"audioManagerEdit-button-process\" class=\"decision-button process\">Process modification</button>\n            </div>\n          </div>\n\n          <div id=\"audioProcessingContainer\">\n            <div anvil-slot=\"feedback_slot\"></div>\n          </div>\n        </div>\n\n        <!-- Text editor remains here -->\n        <div anvil-slot=\"editor_slot\"></div>\n      </div>\n\n      <!-- Report footer remains at the bottom -->\n      <div anvil-slot=\"bottom_buttons_slot\"></div>\n    </div>\n\n    <script>\n      if (!window.__editor_globals) {\n        window.__editor_globals = true;\n        const logger = window.createLogger('AudioManagerEdit');\n        window.setAudioWorkflowState = (state) => {\n          logger.log(`Setting audio workflow state to: ${state}`);\n          const input = document.getElementById('audioInputContainer');\n          const decision = document.getElementById('audioDecisionContainer');\n          const processing = document.getElementById('audioProcessingContainer');\n          if(input) input.style.display = 'none';\n          if(decision) decision.style.display = 'none';\n          if(processing) processing.style.display = 'none';\n          if (state === 'decision') { if(decision) decision.style.display = 'flex'; }\n          else if (state === 'processing') { if(processing) processing.style.display = 'block'; }\n          else { if(input) input.style.display = 'block'; }\n        };\n        window.attachEditorEvents = function() {\n          logger.log('Attaching editor event listeners.');\n          const stableAnchor = document.getElementById('editor-stable-anchor');\n          const reattach = (id, handler) => {\n            const element = document.getElementById(id);\n            if(element) {\n              const newElement = element.cloneNode(true);\n              element.parentNode.replaceChild(newElement, element);\n              newElement.addEventListener('click', handler);\n            } else {\n              logger.warn(`Element with ID '${id}' not found for event attachment.`);\n            }\n          };\n          reattach('audioManagerEdit-button-discard', () => {\n            anvil.call(stableAnchor, 'reset_ui_to_input_state');\n          });\n          reattach('audioManagerEdit-button-process', () => {\n            anvil.call(stableAnchor, 'process_modification');\n          });\n        };\n      }\n      attachEditorEvents();\n    </script>\n  </body>\n</html>"
  type: HtmlTemplate
is_package: true
