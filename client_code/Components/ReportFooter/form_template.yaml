components: []
container:
  properties:
    html: "<style>\n  .bottom-buttons {\n    position: fixed; bottom: 0; left: 50%; transform: translateX(-50%);\n    width: 800px; max-width: 100%; background: #fff; padding: 15px 20px;\n    display: flex; justify-content: center; gap: 20px;\n    border-top: 1px solid #ddd; box-shadow: 0 -2px 4px rgba(0,0,0,0.1); z-index: 10;\n  }\n  .bottom-button {\n    padding: 10px 30px; border: 1px solid #ddd; border-radius: 4px;\n    background: #fff; cursor: pointer; font-size: 14px; transition: all 0.2s ease;\n  }\n  .bottom-button:hover { background: #f5f5f5; border-color: #999; }\n  .primary-button { background-color: #4CAF50; color: white; border-color: #4CAF50; }\n  .primary-button:hover { background-color: #45a049; }\n  #reportFooter-button-share.disabled {\n    background-color: #cccccc; color: #666666; cursor: not-allowed;\n    pointer-events: none; border-color: #bbbbbb;\n  }\n  #status-modal {\n    position: fixed; top: 0; left: 0; width: 100%; height: 100%;\n    background-color: rgba(0,0,0,0.5); z-index: 10010;\n    display: none;\n  }\n  .status-modal-content {\n    background-color: white; padding: 20px; width: 90%; max-width: 320px;\n    border-radius: 8px; box-shadow: 0 4px 10px rgba(0,0,0,0.2);\n  }\n  #status-modal-title {\n    font-size: 18px; font-weight: bold; margin-bottom: 15px; color: #333;\n  }\n  #status-options-list {\n    display: flex; flex-direction: column; gap: 8px;\n  }\n  .status-option-btn {\n    width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px;\n    background: #fff; cursor: pointer; text-align: left; font-size: 16px;\n    transition: background-color 0.2s, border-color 0.2s;\n  }\n  .status-option-btn:hover {\n    background-color: #f5f5f5; border-color: #4CAF50;\n  }\n</style>\n\n<div class=\"bottom-buttons\">\n  <button class=\"bottom-button\" id=\"reportFooter-button-status\">Status</button>\n  <button class=\"bottom-button\" id=\"reportFooter-button-archive\">Archive</button>\n  <!-- <button class=\"bottom-button disabled\" id=\"reportFooter-button-share\">Share</button> -->\n  \n</div>\n\n<div id=\"status-modal\" class=\"modal\">\n  <div class=\"status-modal-content\">\n    <div id=\"status-modal-title\">Choose status:</div>\n    <div id=\"status-options-list\">\n    </div>\n  </div>\n</div>\n\n<script>\n  if (!window.__report_footer_globals) {\n    window.__report_footer_globals = true;\n\n    const logger = window.createLogger('ReportFooter');\n\n    window.setFooterStatusText = function(newStatusText) {\n      const statusBtn = document.getElementById('reportFooter-button-status');\n      if (statusBtn) {\n        statusBtn.textContent = newStatusText || 'Status';\n      }\n    };\n\n    window.showStatusModal = function(title, options) {\n      const titleEl = document.getElementById('status-modal-title');\n      const listContainer = document.getElementById('status-options-list');\n\n      if (!titleEl || !listContainer) {\n        logger.error(\"Éléments de la modale de statut introuvables.\");\n        return;\n      }\n\n      titleEl.textContent = title;\n      listContainer.innerHTML = '';\n\n      options.forEach(opt => {\n        const button = document.createElement('button');\n        button.className = 'status-option-btn';\n        button.textContent = opt.display;\n        button.dataset.value = opt.value;\n\n        button.addEventListener('click', (e) => {\n          const selectedValue = e.currentTarget.dataset.value;\n          anvil.call(document.getElementById('reportFooter-button-status'), 'handle_status_selection', selectedValue);\n          window.closeModal('status-modal');\n        });\n\n        listContainer.appendChild(button);\n      });\n\n      window.openModal('status-modal');\n    };\n\n    window.attachFooterEvents = function() {\n      logger.log('Attaching footer event listeners.');\n      const reattach = (id, event, handler) => {\n        const element = document.getElementById(id);\n        if(element) {\n          const newElement = element.cloneNode(true);\n          element.parentNode.replaceChild(newElement, element);\n          newElement.addEventListener('click', handler);\n        } else {\n          logger.warn(`Element with ID '${id}' not found for event attachment.`);\n        }\n      };\n\n      reattach('reportFooter-button-status', 'click', (e) => {\n        anvil.call(e.target, 'status_button_click');\n      });\n\n      reattach('reportFooter-button-archive', 'click', (e) => {\n        anvil.call(e.target, 'save_button_click');\n      });\n\n      reattach('reportFooter-button-share', 'click', (e) => {\n        anvil.call(e.target, 'share_button_click');\n      });\n\n      const modal = document.getElementById('status-modal');\n      if (modal) {\n        modal.addEventListener('click', (e) => {\n          if (e.target.id === 'status-modal') {\n            window.closeModal('status-modal');\n          }\n        });\n      }\n    };\n  }\n</script>"
  type: HtmlTemplate
custom_component: true
events:
- default_event: true
  name: x_status_clicked
  parameters:
  - {name: status_key}
- {name: x_save_clicked}
- {name: x_share_clicked}
is_package: true
properties: []
