components: []
container:
  properties:
    html: "<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset=\"utf-t\">\n    <title>Registration</title>\n    <style>\n      /* Global & Modal Styles */\n      body { font-family: Arial, sans-serif; margin: 0; background-color: #f5f5f5; }\n      .container { position: relative; width: 100%; height: 100vh; display: flex; align-items: center; justify-content: center; }\n      /* +++ ADD THESE NEW RULES +++ */\n      .modal {\n        display: none; /* Hidden by default */\n        position: fixed; /* Stay in place even when scrolling */\n        z-index: 1000; /* Sit on top of everything */\n        left: 0;\n        top: 0;\n        width: 100%;\n        height: 100%;\n        overflow: auto; /* Enable scroll if needed */\n        background-color: rgba(0,0,0,0.4); /* Black with opacity - THIS CREATES THE GRAY OVERLAY */\n        /* Use flexbox to center the content */\n        align-items: center;\n        justify-content: center;\n      }\n      .modal.active {\n        display: flex; /* Use flex to enable centering */\n      }\n      .modal-content {\n        background: white;\n        padding: 20px;\n        border-radius: 8px;\n        box-shadow: 0 4px 8px rgba(0,0,0,0.2);\n        width: 90%;\n        max-width: 400px;\n      }\n      .modal h2 { margin-top: 0; margin-bottom: 10px; font-size: 22px; color: #333; }\n      .modal p { margin-bottom: 20px; color: #666; font-size: 15px; }\n\n      /* Form Element Styles */\n      .form-group { margin-bottom: 15px; }\n      .form-group label { display: block; margin-bottom: 5px; font-weight: 500; }\n      .form-group input[type=\"text\"],\n      .form-group input[type=\"tel\"],\n      .form-group input[type=\"email\"] { /* Added input[type=\"email\"] here */\n        width: 100%;\n        padding: 10px;\n        border: 1px solid #ddd;\n        border-radius: 4px;\n        font-size: 14px;\n      }\n\n      /* Radio Button & Structure Choice Styles */\n      .radio-group label { display: block; padding: 12px; border: 1px solid #ddd; border-radius: 4px; margin-bottom: 10px; cursor: pointer; transition: all 0.2s ease; }\n      .radio-group label:hover { border-color: #4CAF50; }\n      .radio-group input[type=\"radio\"] { margin-right: 10px; }\n      .radio-group input[type=\"radio\"]:checked + span { font-weight: bold; }\n\n      #join-code-group { display: none; margin-top: 15px; }\n      #join-code-group label { font-size: 14px; color: #333; }\n      #join-code-input { margin-top: 5px; }\n\n      /* Button Styles */\n      .button-group { display: flex; gap: 10px; margin-top: 25px; justify-content: flex-end; }\n      .custom-button { padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; font-weight: 500; transition: background-color 0.3s; }\n      .btn-primary { background-color: #4CAF50; color: white; }\n      .btn-primary:hover { background-color: #45a049; }\n      .btn-default { background-color: #f0f0f0; color: #333; border: 1px solid #ddd; }\n    </style>\n  </head>\n  <body>\n    <div class=\"container\">\n\n      <!-- Step 1: Language Selection -->\n      <div class=\"modal\" id=\"modal-step1\">\n        <div class=\"modal-content\">\n          <h2>Choose Your Language</h2>\n          <p>Please select your preferred language for the application.</p>\n          <div class=\"radio-group\" id=\"language-group\">\n            <label><input type=\"radio\" name=\"language\" value=\"fr\" required> <span>Fran√ßais</span></label>\n            <label><input type=\"radio\" name=\"language\" value=\"en\" checked> <span>English</span></label>\n          </div>\n          <div class=\"button-group\">\n            <div id=\"next-btn-1\" class=\"custom-button btn-primary\">Next</div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Step 2: User Information -->\n      <div class=\"modal\" id=\"modal-step2\">\n        <div class=\"modal-content\">\n          <h2>Your Information</h2>\n          <p>Please enter your name and phone number to continue.</p>\n          <div class=\"form-group\">\n            <label for=\"reg-name\">Name</label>\n            <input type=\"text\" id=\"reg-name\" required>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"reg-phone\">Phone</label>\n            <input type=\"tel\" id=\"reg-phone\" required>\n          </div>\n          <div class=\"button-group\">\n            <div id=\"back-btn-2\" class=\"custom-button btn-default\">Back</div>\n            <div id=\"next-btn-2\" class=\"custom-button btn-primary\">Next</div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Step 3: Structure Selection -->\n      <div class=\"modal\" id=\"modal-step3\">\n        <div class=\"modal-content\">\n          <h2>Set Up Your Practice</h2>\n          <p>How would you like to configure your account?</p>\n          <div class=\"radio-group\" id=\"structure-choice-group\">\n            <label><input type=\"radio\" name=\"structure-choice\" value=\"independent\" checked> <span>Register as Independent</span></label>\n            <label><input type=\"radio\" name=\"structure-choice\" value=\"join\"> <span>Join an Existing Structure</span></label>\n            <label><input type=\"radio\" name=\"structure-choice\" value=\"create\"> <span>Create a New Structure</span></label>\n          </div>\n          <div class=\"form-group\" id=\"join-code-group\">\n            <label for=\"join-code-input\">Structure Join Code</label>\n            <input type=\"text\" id=\"join-code-input\" placeholder=\"Enter the 6-digit code\">\n          </div>\n          <div class=\"button-group\">\n            <div id=\"back-btn-3\" class=\"custom-button btn-default\">Back</div>\n            <div id=\"submit-btn\" class=\"custom-button btn-primary\">Finish Registration</div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Step 4: Create New Structure (NEW MODAL) -->\n      <div class=\"modal\" id=\"modal-step4\">\n        <div class=\"modal-content\">\n          <h2>Create Your New Structure</h2>\n          <p>Please enter the details for your new practice.</p>\n          <div class=\"form-group\">\n            <label for=\"reg-structure-name\">Structure Name</label>\n            <input type=\"text\" id=\"reg-structure-name\" required>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"reg-structure-phone\">Structure Phone</label>\n            <input type=\"tel\" id=\"reg-structure-phone\">\n          </div>\n          <div class=\"form-group\">\n            <label for=\"reg-structure-email\">Structure Email</label>\n            <input type=\"email\" id=\"reg-structure-email\">\n          </div>\n          <div class=\"button-group\">\n            <div id=\"back-btn-4\" class=\"custom-button btn-default\">Back</div>\n            <div id=\"submit-btn-final\" class=\"custom-button btn-primary\">Finish Registration</div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n    <script>\n      // Utility functions for form interaction\n      window.getValueById = (id) => document.getElementById(id)?.value || \"\";\n      window.getRadioValueByName = (name) => document.querySelector(`input[name=\"${name}\"]:checked`)?.value || \"\";\n      window.showModal = function(modalId) {\n        console.log(\"Showing modal:\", modalId);\n        const modal = document.getElementById(modalId);\n\n        // *** FIX: Check if the element exists before using it ***\n        if (modal) {\n          modal.classList.add(\"active\");\n        } else {\n          // Log an error for easier debugging in the future\n          console.error(\"showModal error: Element with ID '\" + modalId + \"' not found.\");\n        }\n      };\n\n      window.hideModal = function(modalId) {\n        console.log(\"Hiding modal:\", modalId);\n        const modal = document.getElementById(modalId);\n\n        // *** FIX: Check if the element exists before using it ***\n        if (modal) {\n          modal.classList.remove(\"active\");\n        } else {\n          // Log an error for easier debugging in the future\n          console.error(\"hideModal error: Element with ID '\" + modalId + \"' not found.\");\n        }\n      };\n\n      // Event attachment function\n      function attachRegistrationEvents() {\n        // Step 1 -> 2\n        document.getElementById('next-btn-1').addEventListener('click', (e) => anvil.call(e.target, 'go_to_step', 2));\n\n        // Step 2 -> 1\n        document.getElementById('back-btn-2').addEventListener('click', (e) => anvil.call(e.target, 'go_to_step', 1));\n        // Step 2 -> 3\n        document.getElementById('next-btn-2').addEventListener('click', (e) => anvil.call(e.target, 'go_to_step', 3));\n\n        // Step 3 -> 2\n        document.getElementById('back-btn-3').addEventListener('click', (e) => anvil.call(e.target, 'go_to_step', 2));\n        // Step 3 -> Submit\n        document.getElementById('submit-btn').addEventListener('click', (e) => anvil.call(e.target, 'submit_registration'));\n        \n        // Step 4 -> 3 (Back)\n        document.getElementById('back-btn-4').addEventListener('click', (e) => {\n          window.hideModal('modal-step4');\n          window.showModal('modal-step3');\n        });\n        // Step 4 -> Final Submit\n        document.getElementById('submit-btn-final').addEventListener('click', (e) => anvil.call(e.target, 'finish_registration_with_structure'));\n        // Logic to show/hide the join code input\n        document.querySelectorAll('input[name=\"structure-choice\"]').forEach(radio => {\n          radio.addEventListener('change', (e) => {\n            const joinGroup = document.getElementById('join-code-group');\n            joinGroup.style.display = (e.target.value === 'join') ? 'block' : 'none';\n          });\n        });\n      }\n\n      // Initializer\n      function initRegistration() {\n        attachRegistrationEvents();\n        showModal(\"modal-step1\");\n      }\n\n      document.readyState === \"loading\" ? document.addEventListener(\"DOMContentLoaded\", initRegistration) : initRegistration();\n\n      const structureChoiceRadios = document.querySelectorAll('input[name=\"structure-choice\"]');\n      const submitBtnStep3 = document.getElementById('submit-btn'); // Get a reference to the button\n\n      structureChoiceRadios.forEach(radio => {\n        radio.addEventListener('change', (e) => {\n          const joinGroup = document.getElementById('join-code-group');\n          joinGroup.style.display = (e.target.value === 'join') ? 'block' : 'none';\n\n          // --- ADD THIS LOGIC ---\n          // Update the button text based on the selection\n          if (e.target.value === 'create') {\n            submitBtnStep3.textContent = 'Next';\n          } else {\n            submitBtnStep3.textContent = 'Finish Registration';\n          }\n          // --- END OF ADDED LOGIC ---\n        });\n      });\n    </script>\n  </body>\n</html>"
  type: HtmlTemplate
is_package: true
